---
aip: AIP-12
title: Improvements to Registry
status: Final
type: Core
author: Aditya Anand <aditya@gitcoin.co>, Kurt Merbeth <kurt@gitcoin.co>
created: 2023-05-31
---


## Abstract
This AIP proposes a set of improvements for the Registry smart contract, focusing on enhancing its functionality, security, and ease of use. The improvements include the integration of OpenZeppelin's Access Control library, the use of unique identifiers for projects, and the implementation of error messaging for better user experience and debugging.

## Motivation
The current implementation of the Registry smart contract can benefit from various enhancements to improve its overall effectiveness. By incorporating industry-standard solutions and addressing key usability issues, we can enhance the contract's security, reliability, and user experience.

## Specification
The proposed improvements for the Registry smart contract are as follows:

### 1. Use OpenZeppelin's Access Control Library
- Integrate OpenZeppelin's Access Control library into the Registry contract.
- The Access Control library provides a standardized and audited implementation for access control functionalities.
- This integration streamlines the management of project ownership and permissions within the contract.
- By leveraging this well-tested solution, we enhance the security and reliability of the contract.

### 2. Use of Unique Identifiers
- Replace the current projectIDs, assigned as simple incrementing numbers, with unique identifiers generated by the `createProjectIdentifier` function.
- The `createProjectIdentifier` function generates a secure and deterministic identifier based on the registry's address, chainId, and projectID.
- Using unique identifiers simplifies the lookup process within the registry and ensures consistency across contracts.
- This change eliminates the need to know the actual incremented projectID when accessing projects, improving usability.
- Extending the use of unique identifiers, already employed for round applications, to the registry enhances project management and overall contract efficiency.

### 3. Implement Error Messaging
- Improve the contract's usability and debugging experience by implementing clear and informative error messages using revert statements.
- Clear error messages are crucial for users to understand why a transaction failed and how to rectify issues.
- Incorporating descriptive error messages enables users to identify and address issues more efficiently, resulting in a smoother interaction with the contract.

## Rationale
The proposed improvements address critical aspects of the Registry smart contract, focusing on functionality, security, and usability. By integrating OpenZeppelin's Access Control library, we leverage a well-tested solution to enhance the contract's access control mechanisms, ensuring better security and reliability. The use of unique identifiers simplifies project lookup and management, improving usability and efficiency. Additionally, implementing descriptive error messages empowers users with better understanding and troubleshooting capabilities, leading to an improved user experience.

## Implementation
The proposed improvements can be implemented by making the following changes to the existing Registry smart contract:

1. Import the Access Control library from OpenZeppelin:
```solidity
import "@openzeppelin/contracts-upgradeable/access/AccessControlEnumerableUpgradeable.sol";
```

2. Modify the contract declaration to inherit from the AccessControlEnumerableUpgradeable contract:
```solidity
contract Registry is Initializable, AccessControlEnumerableUpgradeable {
    // ...
}
```

3. Replace the existing `uint256` projectIDs with `bytes32` projectIDs:
```solidity
mapping(bytes32 => Project) public projects;
```

4. Implement the `createProjectIdentifier` function to generate unique identifiers:
```solidity
function createProjectIdentifier() internal view returns (bytes32) {
    return keccak256(abi.encodePacked(block.chainid, address(this), projectsCount));
}
```

5. Implement the error messages using revert statements throughout the contract, providing clear and informative messages to users.

## Impact
The proposed improvements enhance the functionality, security,

 and usability of the Registry smart contract. Integrating OpenZeppelin's Access Control library improves access control mechanisms, reducing the risk of unauthorized actions. Using unique identifiers simplifies project management and lookup processes, enhancing contract efficiency. The implementation of error messaging provides better user experience and debugging capabilities, facilitating error identification and resolution.

## Conclusion
The proposed improvements outlined in this AIP aim to enhance the functionality, security, and usability of the Registry smart contract. By incorporating the OpenZeppelin Access Control library, introducing unique identifiers, and implementing error messaging, we can provide a more secure, efficient, and user-friendly experience for users interacting with the contract. These improvements will contribute to the overall reliability and effectiveness of the Registry smart contract.

## References
- Discussion : https://github.com/orgs/allo-protocol/discussions/20
- PR: https://github.com/allo-protocol/allo-contracts/pull/47

## Copyright

Copyright and related rights found in [LICENSE](./LICENSE).
